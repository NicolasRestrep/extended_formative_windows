d34 <- df %>% filter(group == "34+")
m1a <- lmer(value ~ (1|id), data = d34)
d34$yhat_i <- predict(m1a)
m1b <- lmer(value ~ wave + (1+wave|id), data = d34)
d34$yhat_c <- predict(m1b)
VD <- 1 - sum((d34$value - d34$yhat_i)^2)/(sum((d34$value - mean(d34$value))^2))
VC <- 1 - sum((d34$value - d34$yhat_c)^2)/(sum((d34$value - mean(d34$value))^2)) - VD
omega_34 <- VC/(VC + VD)
omegas_c7[[i]] <- tibble(var = v, omega_25 = omega_25, k25 = length(unique(d25$id)), n25 = nrow(d25),
omega_33 = omega_33, k33 = length(unique(d33$id)), n33 = nrow(d33),
omega_34 = omega_34, k34 = length(unique(d34$id)), n34 = nrow(d34))
}
canes5 <- canes5 %>% filter(var != "clsrprvtpwr")
vars <- unique(canes5$var)
omegas_c5 <- vector(mode = "list", length = length(vars))
for (i in 1:length(vars)) {
v <- vars[i]
df <- canes5 %>%
filter(var == v) %>%
pivot_longer(y1:y3) %>%
mutate(value = (value - mean(value, na.rm=TRUE))/sd(value,na.rm=TRUE)) %>%
mutate(wave = as.numeric(gsub("y", "", name))) %>%
mutate(group = ifelse(age_1 <= 25, "18-25",
ifelse(age_1 >= 26 & age_1 <= 33, "26-33",
"34+"))) %>%
na.omit()
d25 <- df %>% filter(group == "18-25")
m1a <- lmer(value ~ (1|id), data = d25)
d25$yhat_i <- predict(m1a)
m1b <- lmer(value ~ wave + (1+wave|id),
data = d25)
d25$yhat_c <- predict(m1b)
1 - sum((d25$value - d25$yhat_i)^2)/(sum((d25$value - mean(d25$value))^2))
VD <- 1 - sum((d25$value - d25$yhat_i)^2)/(sum((d25$value - mean(d25$value))^2))
VC <- 1 - sum((d25$value - d25$yhat_c)^2)/(sum((d25$value - mean(d25$value))^2)) - VD
omega_25 <- VC/(VC + VD)
d33 <- df %>% filter(group == "26-33")
m1a <- lmer(value ~ (1|id), data = d33)
d33$yhat_i <- predict(m1a)
m1b <- lmer(value ~ wave + (1+wave|id), data = d33)
d33$yhat_c <- predict(m1b)
VD <- 1 - sum((d33$value - d33$yhat_i)^2)/(sum((d33$value - mean(d33$value))^2))
VC <- 1 - sum((d33$value - d33$yhat_c)^2)/(sum((d33$value - mean(d33$value))^2)) - VD
omega_33 <- VC/(VC + VD)
d34 <- df %>% filter(group == "34+")
m1a <- lmer(value ~ (1|id), data = d34)
d34$yhat_i <- predict(m1a)
m1b <- lmer(value ~ wave + (1+wave|id), data = d34)
d34$yhat_c <- predict(m1b)
VD <- 1 - sum((d34$value - d34$yhat_i)^2)/(sum((d34$value - mean(d34$value))^2))
VC <- 1 - sum((d34$value - d34$yhat_c)^2)/(sum((d34$value - mean(d34$value))^2)) - VD
omega_34 <- VC/(VC + VD)
omegas_c5[[i]] <- tibble(var = v, omega_25 = omega_25, k25 = length(unique(d25$id)), n25 = nrow(d25),
omega_33 = omega_33, k33 = length(unique(d33$id)), n33 = nrow(d33),
omega_34 = omega_34, k34 = length(unique(d34$id)), n34 = nrow(d34))
}
canes7 <- canes7
vars <- unique(canes7$var)
omegas_c7 <- vector(mode = "list", length = length(vars))
for (i in 1:length(vars)) {
v <- vars[i]
df <- canes7 %>%
filter(var == v) %>%
pivot_longer(y1:y3) %>%
mutate(value = (value - mean(value, na.rm=TRUE))/sd(value,na.rm=TRUE)) %>%
mutate(wave = as.numeric(gsub("y", "", name))) %>%
mutate(group = ifelse(age_1 <= 25, "18-25",
ifelse(age_1 >= 26 & age_1 <= 33, "26-33",
"34+"))) %>%
na.omit()
d25 <- df %>% filter(group == "18-25")
m1a <- lmer(value ~ (1|id), data = d25)
d25$yhat_i <- predict(m1a)
m1b <- lmer(value ~ wave + (1+wave|id),
data = d25)
d25$yhat_c <- predict(m1b)
1 - sum((d25$value - d25$yhat_i)^2)/(sum((d25$value - mean(d25$value))^2))
VD <- 1 - sum((d25$value - d25$yhat_i)^2)/(sum((d25$value - mean(d25$value))^2))
VC <- 1 - sum((d25$value - d25$yhat_c)^2)/(sum((d25$value - mean(d25$value))^2)) - VD
omega_25 <- VC/(VC + VD)
d33 <- df %>% filter(group == "26-33")
m1a <- lmer(value ~ (1|id), data = d33)
d33$yhat_i <- predict(m1a)
m1b <- lmer(value ~ wave + (1+wave|id), data = d33)
d33$yhat_c <- predict(m1b)
VD <- 1 - sum((d33$value - d33$yhat_i)^2)/(sum((d33$value - mean(d33$value))^2))
VC <- 1 - sum((d33$value - d33$yhat_c)^2)/(sum((d33$value - mean(d33$value))^2)) - VD
omega_33 <- VC/(VC + VD)
d34 <- df %>% filter(group == "34+")
m1a <- lmer(value ~ (1|id), data = d34)
d34$yhat_i <- predict(m1a)
m1b <- lmer(value ~ wave + (1+wave|id), data = d34)
d34$yhat_c <- predict(m1b)
VD <- 1 - sum((d34$value - d34$yhat_i)^2)/(sum((d34$value - mean(d34$value))^2))
VC <- 1 - sum((d34$value - d34$yhat_c)^2)/(sum((d34$value - mean(d34$value))^2)) - VD
omega_34 <- VC/(VC + VD)
omegas_c7[[i]] <- tibble(var = v, omega_25 = omega_25, k25 = length(unique(d25$id)), n25 = nrow(d25),
omega_33 = omega_33, k33 = length(unique(d33$id)), n33 = nrow(d33),
omega_34 = omega_34, k34 = length(unique(d34$id)), n34 = nrow(d34))
}
summary <- bind_rows(omegas_c5) %>%
select(var, omega_25, omega_33, omega_34) %>%
pivot_longer(omega_25:omega_34) %>%
group_by(name) %>% summarise(mean = mean(value))
summary <- bind_rows(omegas_c7) %>%
select(var, omega_25, omega_33, omega_34) %>%
pivot_longer(omega_25:omega_34) %>%
group_by(name) %>% summarise(mean = mean(value))
summary <- bind_rows(omegas_c5) %>%
select(var, omega_25, omega_33, omega_34) %>%
pivot_longer(omega_25:omega_34) %>%
group_by(name) %>% summarise(mean = mean(value))
bind_rows(omegas_c5) %>%
select(var, omega_25, omega_33, omega_34) %>%
pivot_longer(omega_25:omega_34) %>%
ggplot(aes(x = value, y = name, fill = name)) +
geom_point(data=summary, aes(x =mean, fill = name),
size = 8, shape = 21) +
geom_point(shape = 21) +
theme_bw() +
labs(x = "Omega", y = "", color = "Age Group", fill = "Age Group")
summary <- bind_rows(omegas_c7) %>%
select(var, omega_25, omega_33, omega_34) %>%
pivot_longer(omega_25:omega_34) %>%
group_by(name) %>% summarise(mean = mean(value))
bind_rows(omegas_c7) %>%
select(var, omega_25, omega_33, omega_34) %>%
pivot_longer(omega_25:omega_34) %>%
ggplot(aes(x = value, y = name, fill = name)) +
geom_point(data=summary, aes(x =mean, fill = name),
size = 8, shape = 21) +
geom_point(shape = 21) +
theme_bw() +
labs(x = "Omega", y = "", color = "Age Group", fill = "Age Group")
canes9 <- canes9
vars <- unique(canes7$var)
omegas_c9 <- vector(mode = "list", length = length(vars))
for (i in 1:length(vars)) {
v <- vars[i]
df <- canes9 %>%
filter(var == v) %>%
pivot_longer(y1:y3) %>%
mutate(value = (value - mean(value, na.rm=TRUE))/sd(value,na.rm=TRUE)) %>%
mutate(wave = as.numeric(gsub("y", "", name))) %>%
mutate(group = ifelse(age_1 <= 25, "18-25",
ifelse(age_1 >= 26 & age_1 <= 33, "26-33",
"34+"))) %>%
na.omit()
d25 <- df %>% filter(group == "18-25")
m1a <- lmer(value ~ (1|id), data = d25)
d25$yhat_i <- predict(m1a)
m1b <- lmer(value ~ wave + (1+wave|id),
data = d25)
d25$yhat_c <- predict(m1b)
1 - sum((d25$value - d25$yhat_i)^2)/(sum((d25$value - mean(d25$value))^2))
VD <- 1 - sum((d25$value - d25$yhat_i)^2)/(sum((d25$value - mean(d25$value))^2))
VC <- 1 - sum((d25$value - d25$yhat_c)^2)/(sum((d25$value - mean(d25$value))^2)) - VD
omega_25 <- VC/(VC + VD)
d33 <- df %>% filter(group == "26-33")
m1a <- lmer(value ~ (1|id), data = d33)
d33$yhat_i <- predict(m1a)
m1b <- lmer(value ~ wave + (1+wave|id), data = d33)
d33$yhat_c <- predict(m1b)
VD <- 1 - sum((d33$value - d33$yhat_i)^2)/(sum((d33$value - mean(d33$value))^2))
VC <- 1 - sum((d33$value - d33$yhat_c)^2)/(sum((d33$value - mean(d33$value))^2)) - VD
omega_33 <- VC/(VC + VD)
d34 <- df %>% filter(group == "34+")
m1a <- lmer(value ~ (1|id), data = d34)
d34$yhat_i <- predict(m1a)
m1b <- lmer(value ~ wave + (1+wave|id), data = d34)
d34$yhat_c <- predict(m1b)
VD <- 1 - sum((d34$value - d34$yhat_i)^2)/(sum((d34$value - mean(d34$value))^2))
VC <- 1 - sum((d34$value - d34$yhat_c)^2)/(sum((d34$value - mean(d34$value))^2)) - VD
omega_34 <- VC/(VC + VD)
omegas_c9[[i]] <- tibble(var = v, omega_25 = omega_25, k25 = length(unique(d25$id)), n25 = nrow(d25),
omega_33 = omega_33, k33 = length(unique(d33$id)), n33 = nrow(d33),
omega_34 = omega_34, k34 = length(unique(d34$id)), n34 = nrow(d34))
}
canes9 <- canes9
vars <- unique(canes9$var)
omegas_c9 <- vector(mode = "list", length = length(vars))
for (i in 1:length(vars)) {
v <- vars[i]
df <- canes9 %>%
filter(var == v) %>%
pivot_longer(y1:y3) %>%
mutate(value = (value - mean(value, na.rm=TRUE))/sd(value,na.rm=TRUE)) %>%
mutate(wave = as.numeric(gsub("y", "", name))) %>%
mutate(group = ifelse(age_1 <= 25, "18-25",
ifelse(age_1 >= 26 & age_1 <= 33, "26-33",
"34+"))) %>%
na.omit()
d25 <- df %>% filter(group == "18-25")
m1a <- lmer(value ~ (1|id), data = d25)
d25$yhat_i <- predict(m1a)
m1b <- lmer(value ~ wave + (1+wave|id),
data = d25)
d25$yhat_c <- predict(m1b)
1 - sum((d25$value - d25$yhat_i)^2)/(sum((d25$value - mean(d25$value))^2))
VD <- 1 - sum((d25$value - d25$yhat_i)^2)/(sum((d25$value - mean(d25$value))^2))
VC <- 1 - sum((d25$value - d25$yhat_c)^2)/(sum((d25$value - mean(d25$value))^2)) - VD
omega_25 <- VC/(VC + VD)
d33 <- df %>% filter(group == "26-33")
m1a <- lmer(value ~ (1|id), data = d33)
d33$yhat_i <- predict(m1a)
m1b <- lmer(value ~ wave + (1+wave|id), data = d33)
d33$yhat_c <- predict(m1b)
VD <- 1 - sum((d33$value - d33$yhat_i)^2)/(sum((d33$value - mean(d33$value))^2))
VC <- 1 - sum((d33$value - d33$yhat_c)^2)/(sum((d33$value - mean(d33$value))^2)) - VD
omega_33 <- VC/(VC + VD)
d34 <- df %>% filter(group == "34+")
m1a <- lmer(value ~ (1|id), data = d34)
d34$yhat_i <- predict(m1a)
m1b <- lmer(value ~ wave + (1+wave|id), data = d34)
d34$yhat_c <- predict(m1b)
VD <- 1 - sum((d34$value - d34$yhat_i)^2)/(sum((d34$value - mean(d34$value))^2))
VC <- 1 - sum((d34$value - d34$yhat_c)^2)/(sum((d34$value - mean(d34$value))^2)) - VD
omega_34 <- VC/(VC + VD)
omegas_c9[[i]] <- tibble(var = v, omega_25 = omega_25, k25 = length(unique(d25$id)), n25 = nrow(d25),
omega_33 = omega_33, k33 = length(unique(d33$id)), n33 = nrow(d33),
omega_34 = omega_34, k34 = length(unique(d34$id)), n34 = nrow(d34))
}
summary <- bind_rows(omegas_c9) %>%
select(var, omega_25, omega_33, omega_34) %>%
pivot_longer(omega_25:omega_34) %>%
group_by(name) %>% summarise(mean = mean(value))
bind_rows(omegas_c9) %>%
select(var, omega_25, omega_33, omega_34) %>%
pivot_longer(omega_25:omega_34) %>%
ggplot(aes(x = value, y = name, fill = name)) +
geom_point(data=summary, aes(x =mean, fill = name),
size = 8, shape = 21) +
geom_point(shape = 21) +
theme_bw() +
labs(x = "Omega", y = "", color = "Age Group", fill = "Age Group")
summary <- bind_rows(omegas_c5) %>%
select(var, omega_25, omega_33, omega_34) %>%
pivot_longer(omega_25:omega_34) %>%
group_by(name) %>% summarise(mean = mean(value))
bind_rows(summary_c5, summary_c7, summary_c9)
summary_c5 <- bind_rows(omegas_c5) %>%
select(var, omega_25, omega_33, omega_34) %>%
pivot_longer(omega_25:omega_34) %>%
group_by(name) %>% summarise(mean = mean(value))
bind_rows(omegas_c5) %>%
select(var, omega_25, omega_33, omega_34) %>%
pivot_longer(omega_25:omega_34) %>%
ggplot(aes(x = value, y = name, fill = name)) +
geom_point(data=summary_c5, aes(x =mean, fill = name),
size = 8, shape = 21) +
geom_point(shape = 21) +
theme_bw() +
labs(x = "Omega", y = "", color = "Age Group", fill = "Age Group")
bind_rows(summary_c5, summary_c7, summary_c9)
summary_c7 <- bind_rows(omegas_c7) %>%
select(var, omega_25, omega_33, omega_34) %>%
pivot_longer(omega_25:omega_34) %>%
group_by(name) %>% summarise(mean = mean(value))
bind_rows(omegas_c7) %>%
select(var, omega_25, omega_33, omega_34) %>%
pivot_longer(omega_25:omega_34) %>%
ggplot(aes(x = value, y = name, fill = name)) +
geom_point(data=summary_c7, aes(x =mean, fill = name),
size = 8, shape = 21) +
geom_point(shape = 21) +
theme_bw() +
labs(x = "Omega", y = "", color = "Age Group", fill = "Age Group")
summary_c9 <- bind_rows(omegas_c9) %>%
select(var, omega_25, omega_33, omega_34) %>%
pivot_longer(omega_25:omega_34) %>%
group_by(name) %>% summarise(mean = mean(value))
bind_rows(omegas_c9) %>%
select(var, omega_25, omega_33, omega_34) %>%
pivot_longer(omega_25:omega_34) %>%
ggplot(aes(x = value, y = name, fill = name)) +
geom_point(data=summary_c9, aes(x =mean, fill = name),
size = 8, shape = 21) +
geom_point(shape = 21) +
theme_bw() +
labs(x = "Omega", y = "", color = "Age Group", fill = "Age Group")
bind_rows(summary_c5, summary_c7, summary_c9)
bind_rows(summary_c5, summary_c7, summary_c9) %>%
ggplot(aes(x = mean, y = name)) +
geom_point()
bind_rows(omegas_c9) %>%
select(var, omega_25, omega_33, omega_34) %>%
pivot_longer(omega_25:omega_34) %>%
ggplot(aes(x = value, y = name, fill = name)) +
geom_point(data=summary_c9, aes(x =mean, fill = name),
size = 8, shape = 21) +
geom_point(shape = 21) +
theme_bw() +
labs(x = "Omega", y = "", color = "Age Group", fill = "Age Group")
canes8 <- canes8
vars <- unique(canes8$var)
omegas_c8 <- vector(mode = "list", length = length(vars))
for (i in 1:length(vars)) {
v <- vars[i]
df <- canes8 %>%
filter(var == v) %>%
pivot_longer(y1:y3) %>%
mutate(value = (value - mean(value, na.rm=TRUE))/sd(value,na.rm=TRUE)) %>%
mutate(wave = as.numeric(gsub("y", "", name))) %>%
mutate(group = ifelse(age_1 <= 25, "18-25",
ifelse(age_1 >= 26 & age_1 <= 33, "26-33",
"34+"))) %>%
na.omit()
d25 <- df %>% filter(group == "18-25")
m1a <- lmer(value ~ (1|id), data = d25)
d25$yhat_i <- predict(m1a)
m1b <- lmer(value ~ wave + (1+wave|id),
data = d25)
d25$yhat_c <- predict(m1b)
1 - sum((d25$value - d25$yhat_i)^2)/(sum((d25$value - mean(d25$value))^2))
VD <- 1 - sum((d25$value - d25$yhat_i)^2)/(sum((d25$value - mean(d25$value))^2))
VC <- 1 - sum((d25$value - d25$yhat_c)^2)/(sum((d25$value - mean(d25$value))^2)) - VD
omega_25 <- VC/(VC + VD)
d33 <- df %>% filter(group == "26-33")
m1a <- lmer(value ~ (1|id), data = d33)
d33$yhat_i <- predict(m1a)
m1b <- lmer(value ~ wave + (1+wave|id), data = d33)
d33$yhat_c <- predict(m1b)
VD <- 1 - sum((d33$value - d33$yhat_i)^2)/(sum((d33$value - mean(d33$value))^2))
VC <- 1 - sum((d33$value - d33$yhat_c)^2)/(sum((d33$value - mean(d33$value))^2)) - VD
omega_33 <- VC/(VC + VD)
d34 <- df %>% filter(group == "34+")
m1a <- lmer(value ~ (1|id), data = d34)
d34$yhat_i <- predict(m1a)
m1b <- lmer(value ~ wave + (1+wave|id), data = d34)
d34$yhat_c <- predict(m1b)
VD <- 1 - sum((d34$value - d34$yhat_i)^2)/(sum((d34$value - mean(d34$value))^2))
VC <- 1 - sum((d34$value - d34$yhat_c)^2)/(sum((d34$value - mean(d34$value))^2)) - VD
omega_34 <- VC/(VC + VD)
omegas_c8[[i]] <- tibble(var = v, omega_25 = omega_25, k25 = length(unique(d25$id)), n25 = nrow(d25),
omega_33 = omega_33, k33 = length(unique(d33$id)), n33 = nrow(d33),
omega_34 = omega_34, k34 = length(unique(d34$id)), n34 = nrow(d34))
}
var
v
canes8 <- canes8 %>% filter(term != "thermbaker")
canes
canes8
canes8 <- canes8 %>% filter(var != "thermbaker")
vars <- unique(canes8$var)
omegas_c8 <- vector(mode = "list", length = length(vars))
for (i in 1:length(vars)) {
v <- vars[i]
df <- canes8 %>%
filter(var == v) %>%
pivot_longer(y1:y3) %>%
mutate(value = (value - mean(value, na.rm=TRUE))/sd(value,na.rm=TRUE)) %>%
mutate(wave = as.numeric(gsub("y", "", name))) %>%
mutate(group = ifelse(age_1 <= 25, "18-25",
ifelse(age_1 >= 26 & age_1 <= 33, "26-33",
"34+"))) %>%
na.omit()
d25 <- df %>% filter(group == "18-25")
m1a <- lmer(value ~ (1|id), data = d25)
d25$yhat_i <- predict(m1a)
m1b <- lmer(value ~ wave + (1+wave|id),
data = d25)
d25$yhat_c <- predict(m1b)
1 - sum((d25$value - d25$yhat_i)^2)/(sum((d25$value - mean(d25$value))^2))
VD <- 1 - sum((d25$value - d25$yhat_i)^2)/(sum((d25$value - mean(d25$value))^2))
VC <- 1 - sum((d25$value - d25$yhat_c)^2)/(sum((d25$value - mean(d25$value))^2)) - VD
omega_25 <- VC/(VC + VD)
d33 <- df %>% filter(group == "26-33")
m1a <- lmer(value ~ (1|id), data = d33)
d33$yhat_i <- predict(m1a)
m1b <- lmer(value ~ wave + (1+wave|id), data = d33)
d33$yhat_c <- predict(m1b)
VD <- 1 - sum((d33$value - d33$yhat_i)^2)/(sum((d33$value - mean(d33$value))^2))
VC <- 1 - sum((d33$value - d33$yhat_c)^2)/(sum((d33$value - mean(d33$value))^2)) - VD
omega_33 <- VC/(VC + VD)
d34 <- df %>% filter(group == "34+")
m1a <- lmer(value ~ (1|id), data = d34)
d34$yhat_i <- predict(m1a)
m1b <- lmer(value ~ wave + (1+wave|id), data = d34)
d34$yhat_c <- predict(m1b)
VD <- 1 - sum((d34$value - d34$yhat_i)^2)/(sum((d34$value - mean(d34$value))^2))
VC <- 1 - sum((d34$value - d34$yhat_c)^2)/(sum((d34$value - mean(d34$value))^2)) - VD
omega_34 <- VC/(VC + VD)
omegas_c8[[i]] <- tibble(var = v, omega_25 = omega_25, k25 = length(unique(d25$id)), n25 = nrow(d25),
omega_33 = omega_33, k33 = length(unique(d33$id)), n33 = nrow(d33),
omega_34 = omega_34, k34 = length(unique(d34$id)), n34 = nrow(d34))
}
var
v
canes8 <- canes8 %>% filter(var != "thermbaker",
var != "thermbush")
vars <- unique(canes8$var)
omegas_c8 <- vector(mode = "list", length = length(vars))
for (i in 1:length(vars)) {
v <- vars[i]
df <- canes8 %>%
filter(var == v) %>%
pivot_longer(y1:y3) %>%
mutate(value = (value - mean(value, na.rm=TRUE))/sd(value,na.rm=TRUE)) %>%
mutate(wave = as.numeric(gsub("y", "", name))) %>%
mutate(group = ifelse(age_1 <= 25, "18-25",
ifelse(age_1 >= 26 & age_1 <= 33, "26-33",
"34+"))) %>%
na.omit()
d25 <- df %>% filter(group == "18-25")
m1a <- lmer(value ~ (1|id), data = d25)
d25$yhat_i <- predict(m1a)
m1b <- lmer(value ~ wave + (1+wave|id),
data = d25)
d25$yhat_c <- predict(m1b)
1 - sum((d25$value - d25$yhat_i)^2)/(sum((d25$value - mean(d25$value))^2))
VD <- 1 - sum((d25$value - d25$yhat_i)^2)/(sum((d25$value - mean(d25$value))^2))
VC <- 1 - sum((d25$value - d25$yhat_c)^2)/(sum((d25$value - mean(d25$value))^2)) - VD
omega_25 <- VC/(VC + VD)
d33 <- df %>% filter(group == "26-33")
m1a <- lmer(value ~ (1|id), data = d33)
d33$yhat_i <- predict(m1a)
m1b <- lmer(value ~ wave + (1+wave|id), data = d33)
d33$yhat_c <- predict(m1b)
VD <- 1 - sum((d33$value - d33$yhat_i)^2)/(sum((d33$value - mean(d33$value))^2))
VC <- 1 - sum((d33$value - d33$yhat_c)^2)/(sum((d33$value - mean(d33$value))^2)) - VD
omega_33 <- VC/(VC + VD)
d34 <- df %>% filter(group == "34+")
m1a <- lmer(value ~ (1|id), data = d34)
d34$yhat_i <- predict(m1a)
m1b <- lmer(value ~ wave + (1+wave|id), data = d34)
d34$yhat_c <- predict(m1b)
VD <- 1 - sum((d34$value - d34$yhat_i)^2)/(sum((d34$value - mean(d34$value))^2))
VC <- 1 - sum((d34$value - d34$yhat_c)^2)/(sum((d34$value - mean(d34$value))^2)) - VD
omega_34 <- VC/(VC + VD)
omegas_c8[[i]] <- tibble(var = v, omega_25 = omega_25, k25 = length(unique(d25$id)), n25 = nrow(d25),
omega_33 = omega_33, k33 = length(unique(d33$id)), n33 = nrow(d33),
omega_34 = omega_34, k34 = length(unique(d34$id)), n34 = nrow(d34))
}
summary_c8 <- bind_rows(omegas_c8) %>%
select(var, omega_25, omega_33, omega_34) %>%
pivot_longer(omega_25:omega_34) %>%
group_by(name) %>% summarise(mean = mean(value))
bind_rows(omegas_c8) %>%
select(var, omega_25, omega_33, omega_34) %>%
pivot_longer(omega_25:omega_34) %>%
ggplot(aes(x = value, y = name, fill = name)) +
geom_point(data=summary_c8, aes(x =mean, fill = name),
size = 8, shape = 21) +
geom_point(shape = 21) +
theme_bw() +
labs(x = "Omega", y = "", color = "Age Group", fill = "Age Group")
summary_c5 <- bind_rows(omegas_c5) %>%
select(var, omega_25, omega_33, omega_34) %>%
pivot_longer(omega_25:omega_34) %>%
group_by(name) %>% summarise(mean = mean(value)) %>%
mutate(year = 1956)
bind_rows(omegas_c5) %>%
select(var, omega_25, omega_33, omega_34) %>%
pivot_longer(omega_25:omega_34) %>%
ggplot(aes(x = value, y = name, fill = name)) +
geom_point(data=summary_c5, aes(x =mean, fill = name),
size = 8, shape = 21) +
geom_point(shape = 21) +
theme_bw() +
labs(x = "Omega", y = "", color = "Age Group", fill = "Age Group")
summary_c7 <- bind_rows(omegas_c7) %>%
select(var, omega_25, omega_33, omega_34) %>%
pivot_longer(omega_25:omega_34) %>%
group_by(name) %>% summarise(mean = mean(value)) %>%
mutate(year = 1972)
bind_rows(omegas_c7) %>%
select(var, omega_25, omega_33, omega_34) %>%
pivot_longer(omega_25:omega_34) %>%
ggplot(aes(x = value, y = name, fill = name)) +
geom_point(data=summary_c7, aes(x =mean, fill = name),
size = 8, shape = 21) +
geom_point(shape = 21) +
theme_bw() +
labs(x = "Omega", y = "", color = "Age Group", fill = "Age Group")
summary_c8 <- bind_rows(omegas_c8) %>%
select(var, omega_25, omega_33, omega_34) %>%
pivot_longer(omega_25:omega_34) %>%
group_by(name) %>% summarise(mean = mean(value)) %>%
mutate(year = 1980)
bind_rows(omegas_c8) %>%
select(var, omega_25, omega_33, omega_34) %>%
pivot_longer(omega_25:omega_34) %>%
ggplot(aes(x = value, y = name, fill = name)) +
geom_point(data=summary_c8, aes(x =mean, fill = name),
size = 8, shape = 21) +
geom_point(shape = 21) +
theme_bw() +
labs(x = "Omega", y = "", color = "Age Group", fill = "Age Group")
summary_c9 <- bind_rows(omegas_c9) %>%
select(var, omega_25, omega_33, omega_34) %>%
pivot_longer(omega_25:omega_34) %>%
group_by(name) %>% summarise(mean = mean(value)) %>%
mutate(year = 1992)
bind_rows(omegas_c9) %>%
select(var, omega_25, omega_33, omega_34) %>%
pivot_longer(omega_25:omega_34) %>%
ggplot(aes(x = value, y = name, fill = name)) +
geom_point(data=summary_c9, aes(x =mean, fill = name),
size = 8, shape = 21) +
geom_point(shape = 21) +
theme_bw() +
labs(x = "Omega", y = "", color = "Age Group", fill = "Age Group")
bind_rows(summary_c5, summary_c7, summary_c8, summary_c9) %>%
ggplot(aes(x = mean, y = name)) +
geom_point()
bind_rows(summary_c5, summary_c7, summary_c8, summary_c9) %>%
ggplot(aes(x = mean, y = year)) +
geom_point()
bind_rows(summary_c5, summary_c7, summary_c8, summary_c9)
bind_rows(summary_c5, summary_c7, summary_c8, summary_c9) %>%
ggplot(aes(x = mean, y = year, fill = name)) +
geom_point(shape = 21)
