---
title: "Modeling Change"
author: "Kevin Kiley"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Model

Our central questions are 1) whether respondents in the youngest age group (18-25) make more change in more recent panels than in earlier panels and 2) whether respondents in the next-youngest age group (26-34) become more similar to respondents in the youngest age group over time. To evaluate these hypotheses, we need a measure of the rate of change for respondents of different age groups over time in different era.

A central challenge for this analysis is that panels differ in the questions they ask, the number of times they ask participants to respond to different questions, and the duration between observations.

In the one-item, one-panel case (partisan identification in the 1972-76 panel, for example), we could model the absolute change from wave-to-wave as a function of the duration between observations. 

$$ |y_{i,t}-y_{i,t-1} | = \beta_0 + \beta_1*d_i + \epsilon_i $$

In this equation, $d_{i}$ captures the duration of time between $t-1$ and $t$ in years. In the 1972-76 panel, respondents are asked their partisan identification three times: in the 1972 pre-election survey, in the 1974 pre-election survey, and the 1976 pre-election survey, each about two years apart. If a person participates in all three waves, they have three observations of $|y_{i,t}-y_{i,t-1} |$ and $d_i$: 1972 and 1974 (about 2 years), 1974 and 1976 (about 2 years), and 1972 and 1976 (about 4 years). 

If respondents have a stable underlying partisan identification they report with error, and no real change occurs, then in expectation, duration should be unrelated to absolute change in responses over time, and $\beta_1 = 0$. In this formulation, $\beta_0$ captures the expected absolute change in responses over time when the duration between waves is 0, or, more intuitively, the random deviation between waves that is unrelated to durable change (random noise).  Conversely, $\beta_1$ captures the expected expected change in absolute difference between waves for a one-unit (year) change in duration of observation, or the amount of absolute change we would expect over-and-above the change driven by random noise ($\beta_1$). For example, if a respondent shifts from "strong Democrat" (point 0 on the scale) to "Independent" (point 3 on the scale) between 1972 and 1974, and stays at "Independent" for the 1976 wave, they will have differences of 3, and 0 for the two-year duration (an average of 1.5) and 3 for the four-year duration, generating a positive coefficient for $\beta_1$ if this kind of switching behavior is common.

Our theoretical question deals primarily with whether these coefficients ($\beta_0$ and $\beta_1$) change over time. To explore that, we can add an additional term for time and interact the duration term with time. 

$$ |y_{i,t}-y_{i,t-1} | = \beta_0 + \beta_1d + \beta_2t + \beta_3(d*t) + \epsilon_i $$

In this formulation, $\beta_2$ captures the change in the baseline level of random change over time. A negative value of $\beta_2$ would suggest that people are becoming more consistent reporters of their true underlying opinion over time. $\beta_3$ captures the expected change in absolute change over time for a one-year change in duration. A positive $\beta_3$ value would suggest that people are more likely to undergo a "real" change in their opinion over time in later panels than earlier panels. 

A challenge for our analysis is that while the panels we explore often have relatively large samples, most questions are only asked in a few panels. As such, we lack large numbers of any particular question, meaning our time trends for any individual question is likely to be unstable. One potential solution is to pool questions and estimate a single time trend for stability in attitudes over time, but that is potentially problematic if the kinds of questions asked in later panels are systematically different from the kinds of questions asked in earlier panels. It could also obscure the fact that some items might be becoming more stable over time while others are becoming less stable.

Multilevel models provide an alternative solution to estimate variation in trends in the presence of uncertainty.

$$ |y_{i,j,t}-y_{i,j,t-1} | = \beta_{0j} + \beta_{1j}d + \beta_{2j}t + \beta_{3j}(d*t) + \epsilon_i $$

Where:

$$ \beta_{0j} = \gamma_0 + \upsilon_{0j} $$
$$ \beta_{1j} = \gamma_1 + \upsilon_{1j} $$
$$ \beta_{2j} = \gamma_2 + \upsilon_{2j} $$
$$ \beta_{3j} = \gamma_3 + \upsilon_{3j} $$

In this framework, the first-level model models the absolute difference in a pair of responses to the same question given by the same respondent, similar to what was presented above. The second-level equations represent the items. Each item is assumed to have its own intercept (expected variance at time = 0 and duration = 0) and effects for time, duration, and their interaction. These effects are assumed to be normally distributed around a main effect. 

## Results

```{r}
long_data %>%
  group_by(name) %>%
  nest() %>%
  mutate(t = map(data, lm_func)) %>%
  unnest(t) %>%
  filter(term == "date") %>%
  unnest(data) %>%
  mutate(direction = ifelse(estimate < 0, "negative", "positive")) %>%
  ggplot(aes(x = date, y = a, color = direction)) + 
  facet_wrap(~reorder(name, estimate)) +
  geom_smooth(method = "lm") + 
  theme_bw() + 
  labs(x = "Year", y = "Absolute difference")
```

The figure above presents the expected absolute difference over time generated from separate regressions for each item only on date of observation. This model does not account for varying duration observed in different panels. Generally speaking, most items show a negative slope over time, suggesting that respondents are becoming more stable in their responses over time.

Notably, most of the "feeling thermometer" items show positive slopes over time, suggesting people are becoming more variable in how they feel toward other groups. In contrast, general policy positions show negative slopes over time.

